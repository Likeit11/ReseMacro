# ReseMara GUI 매크로 프로젝트

## 1. 프로젝트 개요
이 프로젝트는 사용자가 코딩 없이 그래픽 인터페이스(GUI)를 통해 직접 이미지 인식 기반 매크로를 만들고 실행할 수 있는 자동화 도구입니다. ADB(Android Debug Bridge)를 이용하여 안드로이드 앱을 제어합니다.

### 주요 특징
- **직관적인 GUI**: 모든 기능을 마우스 클릭으로 제어할 수 있습니다.
- **유연한 명령어 편집**: 매크로 명령어 목록을 쉽게 추가, 수정, 삭제하고 순서를 변경할 수 있습니다.
- **상태 저장 및 복구**: 매크로 진행 상태가 자동으로 저장되어, 프로그램이 중단되어도 마지막 지점부터 이어서 실행할 수 있습니다.
- **실시간 로그**: 매크로의 모든 동작이 로그 창에 실시간으로 표시되어 진행 상황을 쉽게 파악할 수 있습니다.
- **빌드 지원**: `build.py` 스크립트를 통해 프로젝트를 단일 실행 파일로 만들어 다른 사람에게 쉽게 배포할 수 있습니다.

## 2. 프로젝트 구조
- `Source/`: 메인 소스 코드가 위치하는 폴더입니다.
  - `gui.py`: **프로젝트의 메인 실행 파일**입니다. 이 파일을 실행하면 GUI가 시작됩니다.
  - `ReseMara.py`: ADB 연결, 화면 캡처 등 저수준 기능을 담당하는 라이브러리입니다.
  - `macro_engine.py`: 매크로 흐름을 관리하고 실행하는 핵심 엔진입니다.
  - `macro_flow.py`: GUI에서 'Load' 버튼을 눌러 불러올 수 있는 **예시 매크로 파일**입니다.
  - `build.py`: 프로젝트를 단일 실행 파일(.exe)로 빌드하는 스크립트입니다.
- `Ref_Img/`: 매크로가 화면에서 찾을 참조 이미지(`png` 파일)들을 저장하는 폴더입니다.
- `progress.json`: 매크로 실행 중 진행 상황이 자동으로 기록되는 파일입니다. 이 파일을 삭제하면 매크로가 처음부터 다시 시작됩니다.
- `requirements.txt`: 프로젝트 실행에 필요한 파이썬 라이브러리 목록입니다.

## 3. 설치 및 실행 방법

### 방법 1: 소스 코드로 직접 실행 (개발자용)

1.  **요구사항 설치**: 터미널에서 아래 명령어를 실행하여 필요한 라이브러리를 설치합니다.
    ```bash
    pip install -r requirements.txt
    ```
    (만약 `requirements.txt` 파일이 없다면 `python Source/build.py`를 한번 실행하여 생성할 수 있습니다.)

2.  **GUI 실행**: 아래 명령어를 실행하여 GUI 애플리케이션을 시작합니다.
    ```bash
    python Source/gui.py
    ```

### 방법 2: 단일 실행 파일로 빌드하여 사용 (일반 사용자용)

1.  **빌드 스크립트 실행**: 터미널에서 아래 명령어를 실행합니다.
    ```bash
    python Source/build.py
    ```
2.  스크립트가 자동으로 의존성을 설치하고 빌드를 진행합니다.
3.  빌드가 완료되면 프로젝트 루트 폴더 아래에 `dist` 폴더가 생성되고, 그 안에 `ReseMaraGUI.exe` 파일이 만들어집니다.
4.  이제 파이썬 설치 없이 `ReseMaraGUI.exe` 파일만 실행하면 됩니다.

## 4. GUI 사용 가이드

### 4.1. 이미지 준비
매크로가 클릭할 버튼 등의 이미지를 `Ref_Img/` 폴더에 `png` 파일로 저장합니다. 파일 이름은 `login_button.png`와 같이 알아보기 쉽게 짓는 것이 좋습니다.

### 4.2. 파일 관리 (Load / Save)
- **Load**: `File > Load` 메뉴를 클릭하여 기존에 만들어 둔 `.json` 매크로 파일을 불러올 수 있습니다. (`Source/macro_flow.py`가 예시 파일입니다.)
- **Save**: `File > Save` 메뉴를 클릭하여 현재 GUI의 명령어 목록을 새로운 `.json` 파일로 저장할 수 있습니다.

### 4.3. 명령어 편집
1.  **명령어 선택**: 왼쪽 '매크로 명령어 목록'에서 편집하고 싶은 명령어를 클릭하면, 해당 명령어의 내용이 중앙 '파라미터 설정' 창에 표시됩니다.
2.  **파라미터 수정**: 중앙 창에서 원하는 값(이미지 이름, 대기 시간, 좌표 등)을 수정한 후 아래의 제어 버튼을 누릅니다.
    - **Add**: 현재 파라미터 설정 내용으로 **새로운** 명령어를 목록 맨 아래에 추가합니다.
    - **Modify**: **선택된** 명령어의 내용을 현재 파라미터 설정 내용으로 덮어씁니다.
    - **Delete**: **선택된** 명령어를 목록에서 삭제합니다.
    - **Up / Down**: **선택된** 명령어의 순서를 위/아래로 한 칸씩 이동합니다.

### 4.4. 매크로 실행
1.  **ADB 연결**: 'Start' 버튼을 누르면 프로그램이 자동으로 ADB 포트를 검색합니다. 만약 찾지 못하면, 포트 번호를 직접 입력하라는 팝업창이 나타납니다.
2.  **매크로 시작**: ADB 연결에 성공하면 매크로가 자동으로 시작됩니다. 진행 상황은 오른쪽 '로그' 창에 실시간으로 표시됩니다.
3.  **매크로 중지**: 'Stop' 버튼을 누르면 현재 실행 중인 매크로에 안전하게 중지 신호를 보냅니다. 진행 상황은 `progress.json`에 저장되므로, 나중에 'Start'를 누르면 이어서 실행됩니다.

## 5. 핵심 기능: 상태 저장 및 복구
- **자동 저장/복구**: 매크로는 각 행동이 끝날 때마다 `progress.json`에 진행 상황을 기록하며, 재시작 시 자동으로 복구됩니다.
- **초기화**: 매크로를 처음부터 다시 실행하고 싶다면, 프로젝트 폴더에 있는 `progress.json` 파일을 직접 삭제한 후 'Start' 버튼을 누르면 됩니다.